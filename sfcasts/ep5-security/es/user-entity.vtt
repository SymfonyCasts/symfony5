WEBVTT

00:00:01.016 --> 00:00:03.486 align:middle
Lo bueno de la clase User es que...

00:00:03.836 --> 00:00:05.376 align:middle
¡es nuestra clase!

00:00:05.746 --> 00:00:10.406 align:middle
Mientras implementemos UserInterface,
podemos añadir lo que queramos:

00:00:11.076 --> 00:00:15.586 align:middle
Por ejemplo, me gustaría almacenar
el nombre de mis usuarios.

00:00:16.046 --> 00:00:18.536 align:middle
Así que vamos a añadir
una propiedad para eso.

00:00:18.536 --> 00:00:25.136 align:middle
En tu terminal, ejecuta: symfony console
make:entity Editaremos la entidad User, añadiremos

00:00:25.426 --> 00:00:29.486 align:middle
una propiedad firstName, haremos que
sea una cadena, de 255 de longitud...

00:00:29.916 --> 00:00:31.946 align:middle
y di "sí" a anulable.

00:00:32.486 --> 00:00:34.746 align:middle
Hagamos que esta propiedad sea
opcional en la base de datos.

00:00:35.516 --> 00:00:39.586 align:middle
Ya está De vuelta a la clase
User, ¡no hay sorpresas!

00:00:39.876 --> 00:00:41.076 align:middle
Tenemos una nueva propiedad...

00:00:41.406 --> 00:00:43.646 align:middle
y nuevos métodos getter y setter:

00:00:44.246 --> 00:00:47.226 align:middle
Ve a generar una migración
para nuestro nuevo User.

00:00:47.816 --> 00:00:52.946 align:middle
En el terminal, ejecuta symfony
console make:migration ¡Genial!

00:00:53.366 --> 00:00:57.476 align:middle
Gira y abre eso para asegurarte de
que no esconde ninguna sorpresa:

00:00:58.396 --> 00:01:04.586 align:middle
Impresionante: CREATE TABLE user con las
columnas id, email, roles y first_name.

00:01:05.426 --> 00:01:06.746 align:middle
Cierra esto...

00:01:06.746 --> 00:01:13.916 align:middle
y ejecútalo: symfony console
doctrine:migrations:migrate ¡Éxito!

00:01:14.686 --> 00:01:16.776 align:middle
Y como la entidad User es...

00:01:16.916 --> 00:01:21.646 align:middle
una entidad normal de Doctrine , también
podemos añadir usuarios ficticios

00:01:21.646 --> 00:01:24.416 align:middle
a nuestra base de datos utilizando
el sistema de accesorios.

00:01:25.216 --> 00:01:29.436 align:middle
Abre src/DataFixtures/AppFixtures.php.

00:01:29.436 --> 00:01:31.926 align:middle
Estamos utilizando Foundry para
ayudarnos a cargar los datos.

00:01:32.766 --> 00:01:35.796 align:middle
Así que vamos a crear una nueva
fábrica de Foundry para User.

00:01:36.416 --> 00:01:41.656 align:middle
Como nos estamos divirtiendo tanto ejecutando
comandos en este vídeo, vamos a colar uno...

00:01:41.746 --> 00:01:46.736 align:middle
o tres más: symfony
console make:factory ¡Sí!

00:01:46.916 --> 00:01:48.486 align:middle
Queremos una para User.

00:01:49.146 --> 00:01:53.876 align:middle
Ve a abrirlo: src/Factory/UserFactory.php:

00:01:53.876 --> 00:01:57.136 align:middle
Nuestro trabajo en getDefaults()
es asegurarnos de que todas las

00:01:57.136 --> 00:02:01.076 align:middle
propiedades necesarias tienen
buenos valores por defecto.

00:02:02.076 --> 00:02:07.886 align:middle
Establece email en self::faker()->email(),
no estableceré ninguna función por ahora

00:02:08.416 --> 00:02:12.856 align:middle
y establece firstName en
self::faker()->firstName():

00:02:13.546 --> 00:02:21.746 align:middle
¡Genial! En AppFixtures, en la parte inferior,
crea un usuario: UserFactory::createOne().

00:02:22.546 --> 00:02:26.856 align:middle
Pero utiliza un correo electrónico específico
para que podamos iniciar sesión con él más tarde.

00:02:27.376 --> 00:02:30.966 align:middle
Qué tal, abraca_admin@example.com:

00:02:31.876 --> 00:02:38.416 align:middle
Luego, para rellenar un poco el sistema,
añade UserFactory::createMany(10):

00:02:39.286 --> 00:02:40.376 align:middle
¡Vamos a probarlo!

00:02:40.846 --> 00:02:48.026 align:middle
De vuelta al terminal, ejecuta: symfony console
doctrine:fixtures:load ¡No hay errores!

00:02:48.386 --> 00:02:55.816 align:middle
Comprueba la nueva tabla: symfony console
doctrine:query:sql 'SELECT * FROM user' Y...

00:02:56.276 --> 00:02:57.216 align:middle
¡ahí están!

00:02:58.076 --> 00:03:01.646 align:middle
Ahora que tenemos usuarios en la base
de datos, tenemos que añadir una

00:03:01.646 --> 00:03:04.436 align:middle
o varias formas para que se autentiquen.

00:03:05.096 --> 00:03:07.416 align:middle
¡Es hora de construir un formulario de acceso!
